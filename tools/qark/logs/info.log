INFO - Initializing...
INFO - Identified Android SDK installation from a previous run.
INFO - Initializing QARK

INFO - Unpacking /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba.apk
INFO - Zipfile: <zipfile.ZipFile object at 0x10eb806d0>
INFO - Extracted APK to /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/
INFO - <?xml version="1.0" ?><manifest android:versionCode="27" android:versionName="2.4.2" package="com.xesolinnovation.android.escriba" platformBuildVersionCode="24" platformBuildVersionName="7.0" xmlns:android="http://schemas.android.com/apk/res/android">
    <uses-sdk android:minSdkVersion="20" android:targetSdkVersion="24"/>
    <uses-permission android:name="android.permission.BLUETOOTH"/>
    <uses-permission android:name="android.permission.RECORD_AUDIO"/>
    <uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS"/>
    <uses-permission android:name="android.permission.READ_CONTACTS"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.READ_PHONE_STATE"/>
    <uses-permission android:name="android.permission.WAKE_LOCK"/>
    <uses-permission android:name="android.permission.DISABLE_KEYGUARD"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    <uses-permission android:name="com.android.vending.BILLING"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <application android:allowBackup="true" android:icon="@mipmap/ic_launcher" android:label="@string/app_name" android:largeHeap="true" android:name="com.xesolinnovation.escriba.utils.EscribaApplication" android:supportsRtl="true" android:theme="@style/AppTheme">
        <activity android:name="com.xesolinnovation.escriba.ui.activities.SplashActivity" android:screenOrientation="portrait">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.InitialTourActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:launchMode="singleInstance" android:name="com.xesolinnovation.escriba.ui.activities.MainActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.PrivacyActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.ContactsActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.EmojisActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.FAQActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.EscribaGOActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <activity android:name="com.xesolinnovation.escriba.ui.activities.StoreActivity" android:screenOrientation="portrait" android:theme="@style/EscribaStyle"/>
        <service android:name="com.xesolinnovation.escriba.core.input.XNotificationListenerService" android:permission="android.permission.BIND_NOTIFICATION_LISTENER_SERVICE">
            <intent-filter>
                <action android:name="android.service.notification.NotificationListenerService"/>
            </intent-filter>
        </service>
        <service android:enabled="true" android:label="@string/accessibility_service_name" android:name="com.xesolinnovation.escriba.core.input.XAccessibilityService" android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE">
            <intent-filter>
                <action android:name="android.accessibilityservice.AccessibilityService"/>
            </intent-filter>
            <meta-data android:name="android.accessibilityservice" android:resource="@xml/accessibility_service_config"/>
        </service>
        <receiver android:name="com.xesolinnovation.escriba.core.receivers.NotificationButtonReceiver"/>
        <receiver android:name="com.xesolinnovation.escriba.core.receivers.PhoneStateReceiver">
            <intent-filter>
                <action android:name="android.intent.action.PHONE_STATE"/>
            </intent-filter>
        </receiver>
        <receiver android:name="com.xesolinnovation.escriba.core.receivers.LocaleChangedReceiver">
            <intent-filter>
                <action android:name="android.intent.action.LOCALE_CHANGED"/>
            </intent-filter>
        </receiver>
        <meta-data android:name="io.fabric.ApiKey" android:value="beac850ebe2648dcd254a9736166155a0cd8c2a5"/>
        <activity android:name="cat.ereza.customactivityoncrash.activity.DefaultErrorActivity" android:process=":error_activity" android:theme="@style/CustomActivityOnCrashTheme"/>
    </application>
</manifest>
INFO - Determined minimum SDK version to be:20
ISSUES - APP COMPONENT ATTACK SURFACE
WARNING - Backups enabled: Potential for data theft via local attacks via adb backup, if the device has USB debugging enabled (not common). More info: http://developer.android.com/reference/android/R.attr.html#allowBackup
INFO - Checking provider
INFO - Checking activity
WARNING - The following activity are exported, but not protected by any permissions. Failing to protect activity could leave them vulnerable to attack by malicious apps. The activity should be reviewed for vulnerabilities, such as injection and information leakage.
INFO - Checking activity-alias
INFO - Checking services
INFO - Checking receivers
WARNING - The following receiver are exported, but not protected by any permissions. Failing to protect receiver could leave them vulnerable to attack by malicious apps. The receiver should be reviewed for vulnerabilities, such as injection and information leakage.
INFO - Please wait while QARK tries to decompile the code back to source using multiple decompilers. This may take a while.
INFO - Trying to improve accuracy of the decompiled files
INFO - Restored 48 file(s) out of 50 corrupt file(s)
INFO - Decompiled code found at:/Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/
INFO - Finding all java files
INFO - Finding all xml files
INFO - Running Static Code Analysis...
INFO - Looking for private key files in project
INFO - This class is exported from a manifest item: SplashActivity
INFO - Checking this file for vulns: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/ui/activities/SplashActivity.java
INFO - Checking for extras in this file: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/ui/activities/SplashActivity.java from this entry point: onCreate
INFO - This class extends and calls a method in : Activity
INFO - This class is exported from a manifest item: XAccessibilityService
INFO - Checking this file for vulns: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/input/XAccessibilityService.java
INFO - Checking for extras in this file: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/input/XAccessibilityService.java from this entry point: onCreate
INFO - This class extends and calls a method in : AccessibilityService
INFO - This class is exported from a manifest item: XNotificationListenerService
INFO - Checking this file for vulns: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/input/XNotificationListenerService.java
INFO - Checking for extras in this file: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/input/XNotificationListenerService.java from this entry point: onCreate
INFO - This class extends and calls a method in : NotificationListenerService
INFO - This class is exported from a manifest item: LocaleChangedReceiver
INFO - Checking this file for vulns: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/receivers/LocaleChangedReceiver.java
INFO - Checking for extras in this file: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/receivers/LocaleChangedReceiver.java from this entry point: onReceive
INFO - This class is exported from a manifest item: PhoneStateReceiver
INFO - Checking this file for vulns: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/receivers/PhoneStateReceiver.java
INFO - Checking for extras in this file: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/receivers/PhoneStateReceiver.java from this entry point: onReceive
ISSUES - CRYPTO ISSUES
INFO -  No issues to report
ISSUES - BROADCAST ISSUES
WARNING - A broadcast is sent from this class: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/core/process/Engine.java, which does not specify the receiverPermission. This means any application on the device can receive this broadcast. You should investigate this for potential data leakage.
WARNING - A broadcast is sent from this class: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/helpers/LicenseHelper.java, which does not specify the receiverPermission. This means any application on the device can receive this broadcast. You should investigate this for potential data leakage.
ISSUES - CERTIFICATE VALIDATION ISSUES
INFO -  No issues to report
ISSUES - PENDING INTENT ISSUES
POTENTIAL VULNERABILITY - Implicit Intent: localIntent used to create instance of PendingIntent. A malicious application could potentially intercept, redirect and/or modify (in a limited manner) this Intent. Pending Intents retain the UID of your application and all related permissions, allowing another application to act as yours.  File: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/android/support/v4/app/TaskStackBuilder.java More details: https://www.securecoding.cert.org/confluence/display/android/DRD21-J.+Always+pass+explicit+intents+to+a+PendingIntent
POTENTIAL VULNERABILITY - Implicit Intent: localIntent used to create instance of PendingIntent. A malicious application could potentially intercept, redirect and/or modify (in a limited manner) this Intent. Pending Intents retain the UID of your application and all related permissions, allowing another application to act as yours.  File: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/android/support/v4/media/session/MediaButtonReceiver.java More details: https://www.securecoding.cert.org/confluence/display/android/DRD21-J.+Always+pass+explicit+intents+to+a+PendingIntent
ISSUES - FILE PERMISSION ISSUES
INFO -  No issues to report
ISSUES - WEB-VIEW ISSUES
INFO - FOUND 1 WEBVIEWS:
INFO - ['mWebView', '/Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/ui/activities/FAQActivity.java']
INFO - WebView: mWebView
INFO - File: /Users/Kr0n0/Ing.Inversa/Escriba/apk/escriba/classes_dex2jar/com/xesolinnovation/escriba/ui/activities/FAQActivity.java

WARNING - While not a vulnerability by itself, it appears this app has JavaScript enabled in this WebView: mWebView If this is not expressly necessary, you should disable it, to prevent the possibility of XSS (cross-site scripting) attacks. More info: http://developer.android.com/guide/practices/security.html To validate this vulnerability, load the following url in this WebView: http://www.secbro.com/poc/html/JS_WARNING.htmlNote: A local copy of this html file can also be found at <install_dir>/quark/poc/html/JS_WARNING.html

INFO - BaseURL not redefined in this WebView.
WARNING - File system access is enabled in this WebView.mWebView If untrusted data is used to specify the URL opened by this WebView, a malicious app or site may be able to read your app's private files, if it returns the response to them. To validate this vulnerability, load the following url in this WebView: http://www.secbro.com/poc/html/FILE_SYS_WARN.html Note: A local copy of this html file can also be found at <install_dir>/quark/poc/html/FILE_SYS_WARN.html

WARNING - While not a vulnerability by itself, it appears this app does not explicitly disable Content Provider access from WebViews. If the WebViews take in untrusted input, this can allow for data theft.mWebViewTo validate this vulnerability, load the following url in this WebView: http://www.secbro.com/poc/html/WV_CPA_WARNING.html Note: A local copy of this html file can also be found at <install_dir>/quark/poc/html/WV_CPA_WARNING.html

INFO - JavaScript running in file scheme content CAN NOT access content from other origins (setAllowUniversalAccessFromFileURLs=false).mWebView
INFO - JavaScript running in file scheme content CAN NOT access content from other origins (setAllowFileAccessFromFileURLs = false).mWebView
INFO - addJavascriptInterface not used in this WebView.mWebView
INFO - DOM Storage not enabled for this WebView.mWebView
WARNING - Please use the exploit APK to manually test for TapJacking until we have a chance to complete this module. The impact should be verified manually anyway, so have fun...
ISSUES - ADB EXPLOIT COMMANDS
INFO - Until we perfect this, for manually testing, run the following command to see all the options and their meanings: adb shell am. Make sure to update qark frequently to get all the enhancements! You'll also find some good examples here: http://xgouchet.fr/android/index.php?article42/launch-intents-using-adb
INFO - Checking for extras in this file: com.xesolinnovation.escriba.ui.activities.SplashActivity from this entry point: onCreate
INFO - Checking for extras in this file: com.xesolinnovation.escriba.ui.activities.SplashActivity from this entry point: onStart
INFO - Checking for extras in this file: com.xesolinnovation.escriba.core.receivers.LocaleChangedReceiver from this entry point: onReceive
INFO - Checking for extras in this file: com.xesolinnovation.escriba.core.receivers.PhoneStateReceiver from this entry point: onReceive
INFO - Support for other component types and dynamically adding extras is in the works, please check for updates
